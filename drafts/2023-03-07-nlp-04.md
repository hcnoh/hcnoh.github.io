---
layout: post
use_math: true
title: "[Natural Language Processing] 4. BERT"
date: 2023-03-07 00:00:00
tagline: "자연어 처리에서 최근 가장 많이 활용되는 거대 언어 모델의 시초인 BERT에 대해서 정리"
categories:
- Natural Language Processing Study
tags:
- deep learning
- natural language processing
image: /thumbnail-mobile.png
author: "Hyungcheol Noh"
permalink: /2023-03-07-nlp-04
---

이번 포스트에서는 최근 자연어 처리 분야에서 가장 많이 활용되고 있는 거대 언어 모델의 아이디어를 처음으로 제안했단 `BERT`에 대해서 다룬다. BERT는 등장하자마자 획기적이라는 평가를 받았던 언어 모델이며 기존에 존재했던 대부분의 자연어 처리 태스크에서 `SOTA`(State-of-the-Art) 수준을 달성하는 강력한 모습을 보였었다. BERT의 구조와 훈련 방식을 따라가는 구성으로 이번 포스트의 내용을 다뤄볼 계획이다.

## 목차
- [기존 언어 모델 소개]

## 기존 언어 모델 소개
거대 언어 모델 연구는 지금까지 언어 모델에 대한 `사전 학습`(Pre-Training)을 바탕으로 토큰 표현(Representation)을 잘 획득하고 이를 통해 다양한 자연어 처리 태스크를 수행하는 것을 목적으로 수행되어 왔다. 이러한 방향의 언어 모델 연구 역사는 꽤나 오래되었지만 크게 3가지 공통된 방향성이 존재한다.

### ELMo
우선 비지도 특징 기반 접근이 있다. 이 접근은 비지도 기반 특징화를 통해 단어 또는 토큰의 좋은 표현을 획득하려고 했던 연구들을 말한다. 일반적으로는 `정방향`(Left-to-Right) 언어 모델링 기반 목적 함수 최적화를 통해 단어/토큰 표현을 획득했었고 이런 방식은 정방향 언어 모델링은 문장 임베딩(Sentence Embedding), 더 나아가 문단 임베딩(Paragraph Embedding)으로 일반화되어 왔다.

ELMo(Embeddings from Language Models)는 이러한 비지도 특징 기반 접근의 대표적인 언어 모델이다. 기존의 연구들과는 다르게 ELMo는 문장 내에서 최대한 문맥 정보를 추출할 수 있는 방법을 통해 단어 표현을 고도화하고자 하였다. 우선 정방향 언어 모델링 뿐 아니라 `역방향`(Right-to-Left) 언어 모델링을 통한 정보를 둘다 활용하여 `양방향`(Bidirectorional) 언어 모델링을 구현하고자 하였다.

![ELMo](assets/img/2023-03-07-nlp-04/elmo.png)

목적 함수 계산을 위한 ELMo의 양방향 언어 모델링은 다음과 같이 수행된다. 우선 아래와 같이 N개의 토큰이 주어졌다고 가정해 보자.

$$
(t_1, t_2, \cdots, t_N)
$$

여기서 정방향 언어 모델을 통한 토큰 시퀀스 확률 값은 다음과 같다.

$$
p(t_1, t_2, \cdots, t_N) = \prod_{k=1}^N p(t_k | t_1, t_2, \cdots, t_{k-1})
$$

마찬가지로 역방향 언어 모델을 통한 토큰 시퀀스 확률 값도 계산할 수 있다.

$$
p(t_1, t_2, \cdots, t_N) = \prod_{k=N}^1 p(t_k | t_{k+1}, t_{k+2}, \cdots, t_{N})
$$

또한 ELMo는 

![](assets/img/2023-03-07-nlp-04/gpt.png)

![](assets/img/2023-03-07-nlp-04/bert.png)

## 참고 자료
- [BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding](https://arxiv.org/abs/1810.04805)
- [Deep contextualized word representations](https://arxiv.org/abs/1802.05365)

## 수정 사항
- 2023.03.07
    - 최초 게제